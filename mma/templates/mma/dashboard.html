{% extends "mma/base.html" %}
{% block page_title %}MMA – FAX{% endblock %}
{% block mma_content %}
<h1 class="mb-4 text-2xl font-bold">MMA</h1>

<div class="grid gap-6 md:grid-cols-2">
  <section>
    <div class="flex justify-between mb-2">
      <h2 class="text-xl font-semibold">Upcoming Events</h2>
      {% if admin %}<a href="{% url 'mma:event_add' %}" class="text-sm text-blue-400" aria-label="Add Event">Add</a>{% endif %}
    </div>
    <ul class="space-y-2">
      {% for e in upcoming_events %}
        <li class="rounded-lg border p-3 shadow-soft flex justify-between">
          <div>
            <div class="font-medium">{{ e.name }}</div>
            <div class="text-sm text-slate-600">
              {{ e.date_start|date:"d.m.Y H:i" }} – {{ e.organization.short_name }}
            </div>
          </div>
          {% if admin %}<span class="text-sm space-x-2"><a href="{% url 'mma:event_edit' e.slug %}" class="text-slate-400" aria-label="Edit">Edit</a><a href="{% url 'mma:event_delete' e.slug %}" class="text-red-500" aria-label="Delete">Delete</a></span>{% endif %}
        </li>
      {% empty %}
        <li class="text-sm text-slate-500">No upcoming events.</li>
      {% endfor %}
    </ul>
  </section>

  <section>
    <div class="flex justify-between mb-2">
      <h2 class="text-xl font-semibold">Recent Results</h2>
      {% if admin %}<a href="{% url 'mma:event_add' %}" class="text-sm text-blue-400" aria-label="Add Event">Add</a>{% endif %}
    </div>
    <ul class="space-y-2">
      {% for e in recent_results %}
        <li class="rounded-lg border p-3 shadow-soft flex justify-between">
          <div>
            <div class="font-medium">{{ e.name }}</div>
            <div class="text-sm text-slate-600">{{ e.date_start|date:"d.m.Y" }}</div>
          </div>
          {% if admin %}<span class="text-sm space-x-2"><a href="{% url 'mma:event_edit' e.slug %}" class="text-slate-400" aria-label="Edit">Edit</a><a href="{% url 'mma:event_delete' e.slug %}" class="text-red-500" aria-label="Delete">Delete</a></span>{% endif %}
        </li>
      {% empty %}
        <li class="text-sm text-slate-500">No results.</li>
      {% endfor %}
    </ul>
  </section>

  <section class="md:col-span-2">
    <div class="flex justify-between mb-2">
      <h2 class="text-xl font-semibold">Rankings</h2>
      {% if admin %}<a href="{% url 'mma:ranking_add' %}" class="text-sm text-blue-400" aria-label="Add Entry">Add</a>{% endif %}
    </div>
    <table class="min-w-full text-sm">
      <thead>
        <tr class="border-b">
          <th class="px-2 py-1 text-left">#</th>
          <th class="px-2 py-1 text-left">Fighter</th>
          <th class="px-2 py-1 text-left">Weight</th>
          <th class="px-2 py-1 text-left">Org</th>
          {% if admin %}<th class="px-2 py-1 text-right">Actions</th>{% endif %}
        </tr>
      </thead>
      <tbody>
        {% for r in rankings %}
          <tr class="border-b last:border-0">
            <td class="px-2 py-1">{{ r.position }}</td>
            <td class="px-2 py-1">{{ r.fighter.first_name }} {{ r.fighter.last_name }}</td>
            <td class="px-2 py-1">{{ r.weight_class.name }}</td>
            <td class="px-2 py-1">{{ r.organization.short_name }}</td>
            {% if admin %}<td class="px-2 py-1 text-right space-x-2"><a href="{% url 'mma:ranking_edit' r.id %}" class="text-slate-400" aria-label="Edit">Edit</a><a href="{% url 'mma:ranking_delete' r.id %}" class="text-red-500" aria-label="Delete">Delete</a></td>{% endif %}
          </tr>
        {% empty %}
          <tr>
            <td colspan="{% if admin %}5{% else %}4{% endif %}" class="px-2 py-2 text-sm text-slate-500">No rankings.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <section>
    <div class="flex justify-between mb-2">
      <h2 class="text-xl font-semibold">Fighters</h2>
      {% if admin %}<a href="{% url 'mma:fighter_add' %}" class="text-sm text-blue-400" aria-label="Add Fighter">Add</a>{% endif %}
    </div>
    <ul class="space-y-1">
      {% for f in fighters %}
        <li class="flex justify-between"><span class="font-medium">{{ f.first_name }} {{ f.last_name }}</span>{% if admin %}<span class="text-sm space-x-2"><a href="{% url 'mma:fighter_edit' f.slug %}" class="text-slate-400" aria-label="Edit">Edit</a><a href="{% url 'mma:fighter_delete' f.slug %}" class="text-red-500" aria-label="Delete">Delete</a></span>{% endif %}</li>
      {% empty %}
        <li class="text-sm text-slate-500">No fighters.</li>
      {% endfor %}
    </ul>
  </section>

  <section>
    <div class="flex justify-between mb-2">
      <h2 class="text-xl font-semibold">News</h2>
      {% if admin %}<a href="{% url 'mma:news_add' %}" class="text-sm text-blue-400" aria-label="Add News">Add</a>{% endif %}
    </div>
    <ul class="space-y-2">
      {% for n in news_items %}
        <li class="rounded-lg border p-3 shadow-soft flex justify-between">
          <div>
            <div class="font-medium">{{ n.title }}</div>
            <div class="text-sm text-slate-600">{{ n.published_at|date:"d.m.Y" }}</div>
            <p class="text-sm">{{ n.summary }}</p>
          </div>
          {% if admin %}<span class="text-sm space-x-2"><a href="{% url 'mma:news_edit' n.slug %}" class="text-slate-400" aria-label="Edit">Edit</a><a href="{% url 'mma:news_delete' n.slug %}" class="text-red-500" aria-label="Delete">Delete</a></span>{% endif %}
        </li>
      {% empty %}
        <li class="text-sm text-slate-500">No news.</li>
      {% endfor %}
    </ul>
  </section>
</div>
{% endblock %}
