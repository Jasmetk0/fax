{% extends "msa/tournament/base.html" %}

{% block tournament_content %}
  <section class="rounded-xl border border-slate-200 bg-white p-6 shadow-sm" data-testid="tournament-overview">
    <h2 class="text-lg font-semibold text-slate-900">Tournament summary</h2>
    <p class="mt-1 text-sm text-slate-500">Read-only snapshot of klíčových parametrů – žádné editační akce.</p>
    <dl class="mt-4 grid gap-4 md:grid-cols-3">
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Main draw (D)</dt>
        <dd class="mt-1 text-base font-semibold text-slate-900">{{ entry_summary.direct_acceptances|default:"—" }}</dd>
        <p class="text-xs text-slate-500">Draw size {{ entry_summary.draw_size|default:"?" }} · Seeds S={{ entry_summary.seeds }}</p>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Qualifying</dt>
        <dd class="mt-1 text-base font-semibold text-slate-900">{{ entry_summary.qualifiers|default:"0" }} slots</dd>
        <p class="text-xs text-slate-500">{{ entry_summary.qual_rounds|default:"0" }} rounds · Q draw {{ entry_summary.qual_draw_size|default:"0" }}</p>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Best of defaults</dt>
        <dd class="mt-1 text-base font-semibold text-slate-900">MD BO{{ tournament.md_best_of|default:"?" }}</dd>
        <p class="text-xs text-slate-500">Qualification BO{{ tournament.q_best_of|default:"?" }} · Third place {% if tournament.third_place_enabled %}enabled{% else %}no{% endif %}</p>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Wild cards</dt>
        <dd class="mt-1 text-base font-semibold text-slate-900">{{ wc_usage.used }} / {{ wc_usage.limit }}</dd>
        <p class="text-xs text-slate-500">Direct acceptance WC slots in use</p>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Qual WC</dt>
        <dd class="mt-1 text-base font-semibold text-slate-900">{{ qwc_usage.used }} / {{ qwc_usage.limit }}</dd>
        <p class="text-xs text-slate-500">Wild card entries in qualifying draw</p>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Calendar sync</dt>
        <dd class="mt-1 text-base font-semibold text-slate-900">{% if tournament.calendar_sync_enabled %}Enabled{% else %}Disabled{% endif %}</dd>
        <p class="text-xs text-slate-500">Read-only ICS export (globally managed)</p>
      </div>
    </dl>
  </section>

  <section class="mt-6 rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
    <h3 class="text-base font-semibold text-slate-900">Seeding &amp; RNG metadata</h3>
    <div class="mt-4 grid gap-4 md:grid-cols-2">
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Seeding source</dt>
        <dd class="mt-1 text-sm text-slate-800">{{ seeding_source|default:"—" }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Snapshot label</dt>
        <dd class="mt-1 text-sm text-slate-800">{{ snapshot_label|default:"—" }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Seeding Monday</dt>
        <dd class="mt-1 text-sm text-slate-800">{{ seeding_monday|default:"—" }}</dd>
      </div>
      <div>
        <dt class="text-xs font-semibold uppercase tracking-wide text-slate-500">Active RNG seed</dt>
        <dd class="mt-1 text-sm text-slate-800">{{ rng_seed_active|default:"—" }}</dd>
      </div>
    </div>
  </section>

  <section class="mt-6 grid gap-6 lg:grid-cols-2">
    <div class="rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
      <h3 class="text-base font-semibold text-slate-900">Main draw scoring</h3>
      {% if scoring_md_items %}
        <table class="mt-4 w-full text-sm text-slate-600">
          <thead class="text-xs uppercase tracking-wide text-slate-500">
            <tr>
              <th class="py-1 text-left">Round</th>
              <th class="py-1 text-right">Points</th>
            </tr>
          </thead>
          <tbody>
            {% for label, points in scoring_md_items %}
              <tr class="border-t border-slate-100">
                <td class="py-1 text-left">{{ label }}</td>
                <td class="py-1 text-right">{{ points }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="mt-3 text-sm text-slate-500">Scoring matrix zatím není definován.</p>
      {% endif %}
    </div>
    <div class="rounded-xl border border-slate-200 bg-white p-6 shadow-sm">
      <h3 class="text-base font-semibold text-slate-900">Qualification scoring</h3>
      {% if scoring_qual_items %}
        <table class="mt-4 w-full text-sm text-slate-600">
          <thead class="text-xs uppercase tracking-wide text-slate-500">
            <tr>
              <th class="py-1 text-left">Round</th>
              <th class="py-1 text-right">Points</th>
            </tr>
          </thead>
          <tbody>
            {% for label, points in scoring_qual_items %}
              <tr class="border-t border-slate-100">
                <td class="py-1 text-left">{{ label }}</td>
                <td class="py-1 text-right">{{ points }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="mt-3 text-sm text-slate-500">Qualification scoring zatím není nastaven.</p>
      {% endif %}
    </div>
  </section>
{% endblock %}
