{% extends "msa/_base.html" %}
{% load static %}
{% block title %}MSA – Season Calendar{% endblock %}
{% block body %}
  <header class="mb-6">
    <h1 class="text-2xl font-bold">
      Season calendar
      {% if season %}<span class="text-slate-500 text-base align-middle">— {{ season }}</span>{% endif %}
      <span id="season-range" class="ml-2 text-slate-400 text-sm hidden"></span>
    </h1>
    <p class="text-slate-500 text-sm">Klikni na turnaj pro detail. Filtruj podle měsíce, Tour a kategorie.</p>
  </header>

  <section class="mb-4 flex flex-wrap gap-3 items-center">
    <label class="text-sm text-slate-600">
      <span class="mr-2">Měsíc</span>
      <select id="month-filter" class="rounded-md border px-2 py-1"></select>
    </label>
    <label class="text-sm text-slate-600">
      <span class="mr-2">Tour</span>
      <select id="cal-tour" class="rounded-md border px-2 py-1">
        <option value="">Vše</option>
      </select>
    </label>
    <label class="text-sm text-slate-600">
      <span class="mr-2">Category</span>
      <select id="cal-cat" class="rounded-md border px-2 py-1">
        <option value="">Vše</option>
      </select>
    </label>
    <div class="ml-auto flex items-center gap-2 text-sm">
      <span class="text-slate-600">Zobrazení:</span>
      <div class="inline-flex rounded-md border overflow-hidden" role="tablist" aria-label="View mode">
        <button id="mode-months" type="button" class="px-3 py-1 bg-white hover:bg-slate-50" data-mode="months" aria-selected="true">Měsíce</button>
        <button id="mode-days" type="button" class="px-3 py-1 bg-white hover:bg-slate-50 border-l" data-mode="days" aria-selected="false">Dny</button>
      </div>
      <button id="cal-today" type="button" class="ml-3 rounded-md border px-2 py-1">Jump to current</button>
    </div>
  </section>

  <section
    id="cal-root"
    class="rounded-xl border overflow-hidden"
    data-season="{{ season_id|default:'' }}"
  >
    <div id="cal-loading" class="p-6 text-sm text-slate-500">Loading season tournaments…</div>
    <div id="cal-empty" class="hidden p-6 text-sm text-slate-500">No tournaments found for this season.</div>

    <div id="cal-list" class="hidden divide-y">
      <!-- JS will inject grouped-by-month sections -->
    </div>
  </section>
{% endblock %}

{% block extra_js %}
  {{ block.super }}
  <script
    defer
    src="{% static 'msa/js/fax-dates.js' %}?v={% now "U" %}"
  ></script>
  <script
    defer
    src="{% static 'msa/js/calendar.js' %}?v={% now "U" %}"
  ></script>
{% endblock %}
