{% extends 'base.html' %}
{% block extra_head %}
<style>
:root{
  --bg:#0B1220; --surface:#0F172A; --border:#1E293B;
  --text:#F8FAFC; --muted:#A8B2C1;
  --accent:#22D3EE; --accent2:#B2F53C; --challenger:#F97316;
}
html,body{background:var(--bg);color:var(--text)}
.nav-blur{backdrop-filter:saturate(140%) blur(8px);background:rgba(11,18,32,.75);border-bottom:1px solid var(--border)}
.card{background:var(--surface);border:1px solid var(--border);border-radius:16px}
.link-muted{color:rgba(248,250,252,.85)}
.link-muted:hover,.link-active{color:var(--text);text-decoration:underline;text-decoration-color:var(--accent)}
.pill{border-radius:9999px;border:1px solid #FFFFFF22}
.btn-cta{background:linear-gradient(90deg,var(--accent2),var(--accent)); color:#0B1220; box-shadow:0 0 0 1px #ffffff22 inset,0 8px 20px rgba(34,211,238,.18)}
.btn-cta:hover{transform:translateY(-1px)}
.menu-panel{background:var(--surface);border:1px solid var(--border);border-radius:12px;box-shadow:0 16px 40px rgba(0,0,0,.35)}
.segment{border:1px solid #FFFFFF22;padding:.25rem .5rem;border-radius:9999px;cursor:pointer}
.segment[data-active="true"]{background:var(--accent);color:#0B1220;border-color:transparent}
.segment[data-variant="elite"][data-active="true"]{background:var(--accent2)}
.segment[data-variant="challenger"][data-active="true"]{background:var(--challenger)}
.focus-ring:focus{outline:2px solid var(--accent);outline-offset:2px}
.badge{font-size:.75rem;padding:.15rem .45rem;border-radius:9999px;border:1px solid #FFFFFF22}
</style>
<meta property="og:title" content="MSA Squash Tour" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ request.build_absolute_uri }}" />
<meta property="og:image" content="{% static 'msa/og.png' %}" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"SportsOrganization","name":"MSA Squash Tour"}
</script>
{% endblock %}
{% block content %}
{% include 'msa/nav.html' %} <!-- MSA-REDESIGN: include topbar -->
<div class="max-w-7xl mx-auto px-4 py-6">
  {% for message in messages %}
    <div class="mb-4 bg-[color:var(--surface)] text-[color:var(--text)] px-4 py-2 rounded-xl" role="alert">{{ message }}</div>
  {% endfor %}
  {% block msa_content %}{% endblock %}
</div>
<script>
(function(){
  const KEY="msa_tour"; // cookie/localStorage klíč
  const qs=new URLSearchParams(location.search);
  const fromUrl=qs.get("tour");
  const saved=(localStorage.getItem(KEY)||"").toLowerCase();
  let current=(fromUrl||saved||"world").toLowerCase();
  function setActive(t){
    document.querySelectorAll("#tour-switch .segment").forEach(b=>{
      const v=b.dataset.variant;
      b.dataset.active = (v===t) ? "true":"false";
    });
    const url=new URL(location.href);
    url.searchParams.set("tour", t);
    history.replaceState(null,"",url);
    document.cookie = KEY+"="+t+";path=/;max-age=7776000";
    localStorage.setItem(KEY,t);
  }
  document.querySelectorAll("#tour-switch .segment").forEach(b=>{
    b.addEventListener("click",()=>{
      current=b.dataset.variant;
      setActive(current);
      document.dispatchEvent(new CustomEvent("msa:tour-changed",{detail:{tour:current}}));
    });
  });
  setActive(current);
})();
</script>
{% endblock %}
